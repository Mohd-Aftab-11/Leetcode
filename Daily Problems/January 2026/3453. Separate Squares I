import java.util.*;

class Solution {
    public double separateSquares(int[][] squares) {
        int n = squares.length;
        
        long totalArea = 0;
        for (int[] sq : squares) {
            long l = sq[2];
            totalArea += l * l;
        }
        
        double target = totalArea / 2.0;
        
        Map<Long, Long> events = new TreeMap<>();
        for (int[] sq : squares) {
            long y = sq[1];
            long l = sq[2];
            events.put(y, events.getOrDefault(y, 0L) - l);
            events.put(y + l, events.getOrDefault(y + l, 0L) + l);
        }
        
        double currentY = 0;
        double currentAreaAbove = totalArea;
        long currentSlope = 0;
        
        List<Long> sortedY = new ArrayList<>(events.keySet());
        Collections.sort(sortedY);
        
        for (int i = 0; i < sortedY.size(); i++) {
            long nextY = sortedY.get(i);
            
            if (nextY > currentY) {
                double areaAtNextY = currentAreaAbove + currentSlope * (nextY - currentY);
                
                if ((currentAreaAbove >= target && areaAtNextY <= target) ||
                    (currentAreaAbove <= target && areaAtNextY >= target)) {
                    if (currentSlope != 0) {
                        double solutionY = currentY + (target - currentAreaAbove) / currentSlope;
                        if (solutionY >= currentY && solutionY <= nextY) {
                            return solutionY;
                        }
                    } else if (Math.abs(currentAreaAbove - target) < 1e-12) {
                        return currentY;
                    }
                }
                
                currentAreaAbove = areaAtNextY;
                currentY = nextY;
            }
            
            currentSlope += events.get(nextY);
        }
        
        return currentY;
    }
}
